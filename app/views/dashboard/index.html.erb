<div class="flex w-screen">
  <div class="w-1/2 bg-[#333] p-5 ">
    <h1 class="text-3xl text-white pb-10">Tramontana Dash
      <%= link_to "ADD APP",
                  new_app_path,
                  {
                    id: 'a',
                    class: 'text-sm'
                  } %>
    </h1>

    <% @accesses.each_with_index do |access,i| %>

      <div class="w-full flex pb-5"
           data-controller="dashboard"
           data-dashboard-id-value="<%= access.id %>"
           data-dashboard-url-value="<%= access.app.url %>"
           data-dashboard-login-value="<%= access.login || access.app.global_login %>"
           data-dashboard-password-value="<%= access.password || access.app.global_password %>"
           data-dashboard-app-value="<%= access.auto_login %>" >
        
        <a id="<%= i %>" href='#'
                class="w-1/3 bg-black p-3 m-1 rounded-sm text-white cursor-pointer text-left"
                data-action="click->dashboard#send">
          <%= i %>. <%= access.app.name %>
        </a>

        
        <div class="w-1/3 pl-5 pt-3 m-1 text-white">
          <%= access.app.description %>
        </div>

        <div class="text-sm w-1/3 pl-5 pt-3 m-1 text-white">          
          <%= link_to "EDIT APP", edit_app_path(access.app) %> / 
          <%= link_to "ACCESS", edit_access_path(access) %> /
          <%= button_to "DEL", access.app,
                        method: :delete,
                        class: "cursor-pointer",
                        form: {style: 'display:inline-block;'},
                        data: { turbo_confirm: "Are you sure?" } %>
        </div>
      </div>
      
    <% end %>

    <div class="w-full flex">
      <%= link_to "X. Log Out",
                  session_path,
                  {
                    id: 'x',
                    class: "w-1/3 bg-black p-3 m-1 rounded-sm text-white",
                    "data-turbo-method": :delete
                  } %>
    
      <div class="w-2/3 pl-4 pt-3 m-1 text-white">Logout of Dash</div>
    </div>
    
  </div>
  <div class="w-1/2">
    <div class="float-right p-5">
      <img src="tramontana_logo.png" alt="logo" width="130" />

    </div>

    <div class="pt-100 w-full text-center">
      <form action="https://www.google.com/search" method="get">
        <input class=" w-1/2 bg-white p-2" type="text" name="q" placeholder="Google Search">
        <button class="bg-green-500 p-2" type="submit">Search</button>
      </form>
    </div>
    
    <div class="text-5xl pt-30 w-full text-center" id="clock"></div>
    <div class="text-2xl pt-10 w-full text-center" id="weather"></div>
  </div>
</div>

<script>

 // --------------------------------------------------------------------------------
 async function loadWeather() {
   const res = await fetch(
     "https://api.open-meteo.com/v1/forecast?latitude=-37.8136&longitude=144.9631&current_weather=true"
   );
   const data = await res.json();
   const w = data.current_weather;
   document.getElementById("weather").innerHTML =
     `ðŸŒ¤ Melbourne: ${w.temperature}Â°C, wind ${w.windspeed} km/h`;
 }

 loadWeather();

 setInterval(loadWeather, 10 * 60 * 1000); // refresh every 10 minutes
 
 // --------------------------------------------------------------------------------
 // Update Clock
 function updateClock() {
   const now = new Date();
   const timeString = now.toLocaleTimeString();
   const clock = document.getElementById('clock');
   if (clock != null) {
     clock.innerText = timeString;  
   }
   
 }
 setInterval(updateClock, 1000);
 updateClock();
 // --------------------------------------------------------------------------------

 // Hotkey function for links (1, 2, 3)
 document.addEventListener('keydown', function(event) {
   document.getElementById(event.key).click();
 });
</script>

